---
name: server
description: Backend implementation — API routes, middleware, request handling, streaming, and server-side state management
---

# Server

### Last 3 Days  
The server backend processes conversation inputs by chunking message content and invoking the GPT-4.1-mini model to generate "add_observation" tool calls that extract and classify text snippets with importance metadata. These observations are stored in a database and linked to base models ('self', 'user', 'system') or dynamically created models representing recurring topics or entities via an "assign_model" LLM tool call.  

Model descriptions are generated by sampling existing observations and running parallelized LLM calls (using ThreadPoolExecutor) to produce concise purpose summaries (<100 characters). Both assignment and synthesis processes handle large datasets with concurrency and provide progress feedback. Prompting for assignments combines fixed base models and dynamically generated models alongside representative samples and purpose statements to improve classification precision.  

Embedding generation is batched with respect to OpenAI API limits (max 250,000 tokens, 2048 items per batch) and executed concurrently to optimize throughput. SQLAlchemy session management within threaded environments is addressed by pre-fetching samples before parallel processing during model description synthesis.  

A dedicated git repository loader converts git logs and diffs into conversation message format compatible with the pipeline, supporting diff truncation, incremental loading by commit hashes, and accurate timestamp mapping. The extraction prompt (GIT_OBSERVE_SYSTEM_PROMPT) instructs the model to focus on architectural elements—subsystem patterns, data flows, design decisions, API usage, technology choices—while ignoring personal data. The server CLI exposes a `--git import` command that accepts repository paths and optional date filters to trigger automated code-aware extraction traversing commits, feeding messages for observation extraction and synthesis.

---

### This Week  
(No additional content beyond Last 3 Days)  

---

### This Month  
(No additional content beyond Last 3 Days)  

---

### This Quarter  
(No additional content beyond Last 3 Days)  

---

### This Year  
(No additional content beyond Last 3 Days)  

---

### Earlier  
(No content provided)
